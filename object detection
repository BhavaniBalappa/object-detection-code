# 1. Install required libraries
!pip install ultralytics opencv-python-headless

# 2. User uploads room image
from google.colab import files
uploaded = files.upload()   # USER selects room image here

# 3. Object detection with MAXIMUM ACCURACY
from ultralytics import YOLO
import cv2
import matplotlib.pyplot as plt

# Load MOST POWERFUL YOLOv8 model
model = YOLO("yolov8x.pt")   # Highest accuracy

# Get uploaded image
img_path = list(uploaded.keys())[0]
print("‚úÖ User uploaded:", img_path)

# Read image
img = cv2.imread(img_path)

# Run detection with LOW confidence threshold
results = model(img, conf=0.1)   # 0.1 = detect more objects

boxes = results[0].boxes
names = model.names

detected_objects = []

print("\n‚úÖ ALL OBJECTS DETECTED IN THE ROOM:\n")

for box in boxes:
    class_id = int(box.cls[0])
    confidence = float(box.conf[0])
    object_name = names[class_id]
    detected_objects.append(object_name)
    print(f"üéØ {object_name} | Confidence: {confidence:.2f}")

# Draw bounding boxes
output_image = results[0].plot()

# Save output
cv2.imwrite("room_detected_output.jpg", output_image)

# Show image
plt.figure(figsize=(10,10))
plt.imshow(cv2.cvtColor(output_image, cv2.COLOR_BGR2RGB))
plt.axis("off")
plt.show()

print("\n‚úÖ FINAL OBJECT LIST FOUND IN THE ROOM:")
print(set(detected_objects))

print("\nüìÅ Output saved as: room_detected_output.jpg")
